<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Alexandre Thiéry - Averaging and homogenization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../../data/dice.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HJ0JLEF802"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HJ0JLEF802', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Alexandre Thiéry - Averaging and homogenization">
<meta property="og:description" content="">
<meta property="og:site-name" content="Alexandre Thiéry">
<meta name="twitter:title" content="Alexandre Thiéry - Averaging and homogenization">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@alexxthiery">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alexandre Thiéry</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../people/index_people.html" rel="" target="">
 <span class="menu-text">Research Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications/index_pubs.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching/teaching.html" rel="" target="">
 <span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/index_notes.html" rel="" target="">
 <span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../notes/index_notes_as_list.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Averaging and homogenization</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">diffusion</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">28 11 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">28 11 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#averaging" id="toc-averaging" class="nav-link active" data-scroll-target="#averaging">Averaging</a></li>
  <li><a href="#homogenization" id="toc-homogenization" class="nav-link" data-scroll-target="#homogenization">Homogenization</a></li>
  <li><a href="#closed-form-solution-poisson-equation" id="toc-closed-form-solution-poisson-equation" class="nav-link" data-scroll-target="#closed-form-solution-poisson-equation">Closed form solution &amp; Poisson equation:</a></li>
  <li><a href="#example-integrated-ou-process" id="toc-example-integrated-ou-process" class="nav-link" data-scroll-target="#example-integrated-ou-process">Example: integrated OU process</a></li>
  <li><a href="#example-overdamped-langevin-dynamics" id="toc-example-overdamped-langevin-dynamics" class="nav-link" data-scroll-target="#example-overdamped-langevin-dynamics">Example: Overdamped Langevin Dynamics</a></li>
  <li><a href="#example-stratonovich-corrections" id="toc-example-stratonovich-corrections" class="nav-link" data-scroll-target="#example-stratonovich-corrections">Example: Stratonovich Corrections</a></li>
  <li><a href="#readings" id="toc-readings" class="nav-link" data-scroll-target="#readings">Readings</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="averaging" class="level3">
<h3 class="anchored" data-anchor-id="averaging">Averaging</h3>
<p>Consider a pair of (coupled) Markov processes <span class="math inline">\(X_t \in \mathcal{X}\)</span> and <span class="math inline">\(Y_t \in \mathcal{Y}\)</span> with dynamics that can informally be described as</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon}/dt &amp;= F(X^{\varepsilon},Y^{\varepsilon}, W^X)\\
dY^{\varepsilon}/dt &amp;=  \textcolor{red}{\varepsilon^{-1}} \, G(X^{\varepsilon},Y^{\varepsilon}, W^Y)\\
\end{align}
\right.
\]</span></p>
<p>for two independent “noise” terms <span class="math inline">\(W^X\)</span> and <span class="math inline">\(W^Y\)</span> and a time-scale parameter <span class="math inline">\(\varepsilon\ll 1\)</span>. We assume that <span class="math inline">\(X\)</span> is a <strong>slow component</strong> that moves by <span class="math inline">\(\mathcal{O}(\delta)\)</span> in on the time interval <span class="math inline">\([t, t+\delta]\)</span>. The scaling <span class="math inline">\(\varepsilon^{-1}\)</span> in the dynamics of <strong>fast process</strong> <span class="math inline">\(Y^{\varepsilon}\)</span> indicates that we expect the process <span class="math inline">\(Y\)</span> to evolve on a time scale of order <span class="math inline">\(\mathcal{O}(\varepsilon)\)</span>. We are interested in the limit <span class="math inline">\(\varepsilon\to 0\)</span> and hope to “average out” the fast process <span class="math inline">\(Y^{\varepsilon}\)</span> and be able to describe the slow (and interesting) process <span class="math inline">\(X^{\varepsilon}\)</span> without referring to the fast process. Informally, we would like to describe the process <span class="math inline">\(X^{\varepsilon}\)</span>, in the limit <span class="math inline">\(\varepsilon\to 0\)</span>, as following an effective Markovian dynamics</p>
<p><span class="math display">\[
dX/dt = \overline{F}(X, W^X).
\]</span></p>
<p>For describing the averaging phenomenon, we typically assume some ergodicity conditions on the fast process <span class="math inline">\(Y\)</span>. Here, we assume that for each fixed <span class="math inline">\(x \in \mathcal{X}\)</span>, the fast process process <span class="math inline">\(Y^{[x]}\)</span> with fixed slow-component <span class="math inline">\(x \in \mathcal{X}\)</span>, i.e.</p>
<p><span class="math display">\[
dY^{[x]}/dt = G(x,Y^{[x]}, W^Y)
\]</span></p>
<p>is ergodic with respect to some probability distribution <span class="math inline">\(\rho_x(dy)\)</span>. Although the averaging phenomenon is quite general, it is somewhat easier to illustrate it for diffusion processes. In this case, let us assume that the slow process is given by</p>
<p><span class="math display">\[
dX^{\varepsilon} = \mu(X^{\varepsilon}, Y^{\varepsilon}) \, dt + \sigma(X^{\varepsilon}, Y^{\varepsilon}) \, dW^x.
\]</span></p>
<p>For <span class="math inline">\(X^{\varepsilon}_{t} = x\)</span> and for a time increment <span class="math inline">\(\delta \ll 1\)</span>, since the process <span class="math inline">\(X^{\varepsilon}\)</span> can be considered constant we have</p>
<p><span class="math display">\[
\begin{align}
X^{\varepsilon}_{t+\delta} - x
&amp;\approx \;
{\left(  \frac{ \int_{t}^{t+\delta} \mu(x, Y^{\varepsilon}) \, dt}{\delta}  \right)}  \, \delta + \
{\left(  \frac{ \int_{t}^{t+\delta} \sigma^2(x, Y^{\varepsilon}) }{\delta} \right)} ^{1/2} \, \mathcal{N}(0, \delta).
\end{align}
\]</span></p>
<p>This can be regarded as a time-discretization of the <strong>averaged process</strong></p>
<p><span class="math display">\[
dX \, = \; \overline{\mu}(X) \, dt + \overline{\sigma}(X) \, dW
\]</span></p>
<p>for averaged drift and volatility functions give by</p>
<p><span id="eq-av-diff"><span class="math display">\[
\left\{
\begin{align}
\overline{\mu}(x)
&amp;=
\int \mu(x,y) \, \rho_x(dy) \\
\overline{\sigma}^2(x)
&amp;= \int \sigma^2(x,y) \, \rho_x(dy).
\end{align}
\right.
\tag{1}\]</span></span></p>
<p>One standard approach for proving this type of results is to write the Kolmogorov equations</p>
<p><span class="math display">\[\frac{d}{dt}\varphi^{\varepsilon}(x,y,t) = \mathcal{L}^{\varepsilon} \varphi^{\varepsilon}(x,y,t)\]</span> for <span class="math inline">\(\varphi^{\varepsilon}(x,y,t) = \mathop{\mathrm{E}}[\varphi(X^{\varepsilon}_{t}, Y^{\varepsilon}_{t}, t) | X^{\varepsilon}_{0}=x, Y^{\varepsilon}_{0}=y]\)</span> and perform a <a href="https://en.wikipedia.org/wiki/Method_of_matched_asymptotic_expansions">multiscale expansion</a> <span class="citation" data-cites="hinch_1991">(<a href="#ref-hinch_1991" role="doc-biblioref">Hinch 1991</a>)</span> <span class="citation" data-cites="pavliotis2008multiscale">(<a href="#ref-pavliotis2008multiscale" role="doc-biblioref">Pavliotis and Stuart 2008</a>)</span> <span class="citation" data-cites="weinan2011principles">(<a href="#ref-weinan2011principles" role="doc-biblioref">Weinan 2011</a>)</span></p>
<p><span id="eq-multiscale"><span class="math display">\[
\varphi^{\varepsilon}(x,y,t)
=
A(x,t) + \varepsilon B(x,y,t) + \mathcal{O}(\varepsilon^2).
\tag{2}\]</span></span></p>
<p>Indeed, the first order term <span class="math inline">\(A(x,t)\)</span> is expected to not depend on the initial condition <span class="math inline">\(y\)</span> since the process <span class="math inline">\((X^{\varepsilon}_t, Y^{\varepsilon}_t)\)</span> forgets <span class="math inline">\(Y^{\varepsilon}_0 = y\)</span> on time scales of order <span class="math inline">\(\varepsilon\)</span> and we are interested in the regime <span class="math inline">\(\varepsilon\to 0\)</span>. From <a href="#eq-multiscale">Equation&nbsp;2</a> one can obtain the dynamics of the averaged process described by the function <span class="math inline">\(A(x,t)\)</span>. One finds that <span class="math inline">\(A\)</span> is described by the averaged generator of the slow component, i.e.&nbsp;averaging <span class="math inline">\(\mathcal{L}^{X^{\varepsilon}}\)</span> under <span class="math inline">\(\rho_x(dy)\)</span>; this exactly gives <a href="#eq-av-diff">Equation&nbsp;1</a> in the case of diffusions. A typical example could be as follows:</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon} &amp;= \mu(X^{\varepsilon}, Y^{\varepsilon}) dt + \sigma(X^{\varepsilon}, Y^{\varepsilon}) \, dW^X\\
dY^{\varepsilon} &amp;= - \textcolor{red}{\varepsilon^{-1}} \frac{ (Y^{\varepsilon} - X^{\varepsilon}) }{\sigma^2} \, dt + \sqrt{2  \textcolor{red}{\varepsilon^{-1}} } \, dW^Y.\\
\end{align}
\right.
\]</span></p>
<p>The fast process <span class="math inline">\(Y^{\varepsilon}_t\)</span> is a <a href="https://en.wikipedia.org/wiki/Ornstein–Uhlenbeck_process">Ornstein-Uhlenbeck</a> process sped-up by a factor <span class="math inline">\(1/\varepsilon\)</span> that will very rapidly oscillate around <span class="math inline">\(X^{\varepsilon}_t\)</span>, with Gaussian fluctuations with variance <span class="math inline">\(\sigma^2&gt;0\)</span>, ie:</p>
<p><span class="math display">\[
\rho_x(dy) \; = \; \frac{ e^{-(y-x)^2/2} }{\sqrt{2\pi \sigma^2}}\, dy.
\]</span></p>
<p>This averaging phenomenon is relatively straightforward and not extremely surprising. More interesting is the homogenization phenomenon described in the next Section.</p>
</section>
<section id="homogenization" class="level3">
<h3 class="anchored" data-anchor-id="homogenization">Homogenization</h3>
<p>Consider the presence of an additional intermediate time scale <span class="math inline">\(\varepsilon^{-1/2}\)</span>, <span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon}/dt &amp;=  \textcolor{blue}{\varepsilon^{-1/2} H(X^{\varepsilon},Y^{\varepsilon})} \, + \,F(X^{\varepsilon},Y^{\varepsilon}, W^X)\\
dY^{\varepsilon}/dt &amp;=  \textcolor{red}{\varepsilon^{-1}} \, G(X^{\varepsilon},Y^{\varepsilon}, W^Y)\\
\end{align}
\right.
\]</span> with the same assumption that for any fixed <span class="math inline">\(x \in \mathcal{X}\)</span> the process <span class="math inline">\(dY^{[x]}/dt = G(x,Y^{[x]}, W^Y)\)</span> is ergodic with respect to the probability distribution <span class="math inline">\(\rho_x(dy)\)</span>. The same reasoning as in the averaging case shows that averaging the term <span class="math inline">\(F(X^{\varepsilon},Y^{\varepsilon}, W^X)\)</span> is relatively straightforward and has the exact same expression: it suffices to average under <span class="math inline">\(\rho_x(dy)\)</span>. This means that one can study instead</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon}/dt &amp;=  \textcolor{blue}{\varepsilon^{-1/2} H(X^{\varepsilon},Y^{\varepsilon})} \, + \, \overline{F}(X^{\varepsilon}, W^X)\\
dY^{\varepsilon}/dt &amp;=  \textcolor{red}{\varepsilon^{-1}} \, G(X^{\varepsilon},Y^{\varepsilon}, W^Y)\\
\end{align}
\right.
\]</span></p>
<p>with, informally, <span class="math inline">\(\overline{F}(x,w) = \int F(x,y,w) \, \rho_x(dy)\)</span>. The new interesting phenomenon is coming from the intermediate time scale <span class="math inline">\(\varepsilon^{-1/2}\)</span>. Contrarily to the averaging phenomenon of the previous section that was only relying on a Law of Large Numbers, dealing with the intermediate time-scale requires exploiting a CLT and quantifying the rate of mixing of the fast process <span class="math inline">\(Y^{[x]}\)</span> Note that since <span class="math inline">\(\varepsilon^{-1/2} \gg 1\)</span>, for the dynamics to not explode one needs the <strong>centering condition</strong>:</p>
<p><span id="eq-centering"><span class="math display">\[
\int_{\mathcal{Y}} H(x,y) \, \rho_x(dy) = 0
\qquad \textrm{for all } x \in \mathcal{X}.
\tag{3}\]</span></span></p>
<p>Because of the centering condition*, the term <span class="math inline">\( \textcolor{blue}{\varepsilon^{-1/2} H(X^{\varepsilon},Y^{\varepsilon})}\)</span> will contribute an additional noise term in the effective dynamics of the slow process. To describe this additional noise term, assume an ergodic central limit theorem (CLT) for the fast process <span class="math inline">\(dY^{[x]}/dt = G(x,Y^{[x]}, W^Y)\)</span>: for a test function <span class="math inline">\(\varphi: \mathcal{Y}\to \mathbb{R}\)</span> with zero expectation under <span class="math inline">\(\rho_x(dy)\)</span> we have:</p>
<p><span id="eq-CLT"><span class="math display">\[
\lim_{t \to \infty} \; T^{-1/2}
\int_{t=0}^T \, \varphi(Y^{[x]}_t) \, dt
\; = \; \mathcal{N}(0, V_x[\varphi])
\tag{4}\]</span></span></p>
<p>for asymptotic variance <span class="math inline">\(V_x[\varphi] \geq 0\)</span>. For a time increment <span class="math inline">\(\delta &gt; 0\)</span> and assuming <span class="math inline">\(X^{\varepsilon}_{t}=x\)</span> we have</p>
<p><span id="eq-split"><span class="math display">\[
\begin{align}
X^{\varepsilon}_{t+\delta} - x
&amp;\approx  \textcolor{blue}{ \varepsilon^{-1/2} \, \int_{u=t}^{t+\delta} H(X^{\varepsilon}_u,Y^{\varepsilon}_u)} \, du \, + \, \int_{u=t}^{t+\delta} \overline{F}(x, W^X_u) \, du.
\end{align}
\tag{5}\]</span></span></p>
<p>The second integral term is an averaging term that can be treated easily. Approximating the process <span class="math inline">\(t \mapsto Y^{\varepsilon}_t\)</span> by <span class="math inline">\(t \mapsto Y^{[x]}_{t \varepsilon^{-1}}\)</span>, the first integral on the RHS of <a href="#eq-split">Equation&nbsp;5</a> can be approximated as</p>
<p><span class="math display">\[
\begin{align}
\underbrace{\varepsilon^{-1/2} \int_{u=t}^{t+\delta}  H(x,Y^{[x]}_{u \, \varepsilon^{-1}}) \, du}_{\textrm{CLT}} \,
+
\underbrace{\int_{u=t}^{t+\delta} \varepsilon^{-1/2} \partial_x H(x,Y^{[x]}_{u \, \varepsilon^{-1}}) \, (X^{\varepsilon}_u - x) \, \, du}_{\textrm{(drift)}}.
\end{align}
\]</span></p>
<p>After a time-rescaling, one can readily see that the first term is described by the CLT of <a href="#eq-CLT">Equation&nbsp;4</a>,</p>
<p><span class="math display">\[
\varepsilon^{-1/2} \int_{u=t}^{t+\delta}  H(x,Y^{[x]}_{u \, \varepsilon^{-1}}) \, du
\approx V_x[H(x, \cdot)]^{1/2} \mathcal{N}(0, \delta).
\]</span></p>
<p>The second term is further approximated as</p>
<p><span class="math display">\[
\begin{align}
\varepsilon^{-1} \, &amp;\int_{u=t}^{t+\delta}\int_{v=t}^{t+\delta}
\partial_x H(x,Y^{[x]}_{u \, \varepsilon^{-1}}) \, H(x,Y^{[x]}_{v \, \varepsilon^{-1}}) \, 1_{v&lt;u} \, du \, dv\\
&amp;=  {\left(  \frac{1}{\delta \varepsilon^{-1}} \int_{u=t}^{t+\delta \varepsilon^{-1}}\int_{v=t}^{t+\delta \varepsilon^{-1}} \partial_x H(x,Y^{[x]}_{u}) \, H(x,Y^{[x]}_{v}) \, 1_{v&lt;u}  \right)}  \, \delta,
\end{align}
\]</span></p>
<p>the second equality coming from the time-rescaling <span class="math inline">\(t \mapsto t \varepsilon\)</span>. The process <span class="math inline">\(Y^{[x]}\)</span> mixes on scale <span class="math inline">\(\mathcal{O}(1)\)</span> so that the term inside bracket <span class="math inline">\( {\left( \ldots \right)} \)</span> converges to its expectation. Setting <span class="math inline">\(T = \delta \, \varepsilon^{-1} \to \infty\)</span>, one obtains</p>
<p><span class="math display">\[
\begin{align}
I(x) &amp;=
\frac{1}{T} \iint_{[0,T]^2}
\partial_x H(x,Y^{[x]}_{u}) \, H(x,Y^{[x]}_{v}) \, 1_{v&lt;u}  \, du \, dv \\
&amp;\to
\int \rho_x(dy) \, H(x,y) \,   {\left\{  \int_{s=0}^{\infty} \mathop{\mathrm{E}}[\partial_x H(\hat{x}, Y^{[x]}_s) \, |  Y^{[x]}_0=y] \, ds  \right\}} .
\end{align}
\]</span></p>
<p>In conclusion, the fast-slow system</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon} &amp;=  \textcolor{blue}{\varepsilon^{-1/2} \, H(X^{\varepsilon}, Y^{\varepsilon})} \, dt + \mu(X^{\varepsilon}, Y^{\varepsilon}) \, dt + \sigma(X^{\varepsilon}, Y^{\varepsilon}) \, dW^x\\
dY^{\varepsilon} &amp;=  \textcolor{red}{\varepsilon^{-1}} \, G(X^{\varepsilon},Y^{\varepsilon}, W^Y) \, dt
\end{align}
\right.
\]</span></p>
<p>can be described in the regime <span class="math inline">\(\varepsilon\to 0\)</span> by the effective dynamics</p>
<p><span class="math display">\[
dX =  \textcolor{blue}{I(X) \, dt + \Gamma^{1/2}(X) \, dW^{H}}
+
\overline{\mu}(X) \, dt + \overline{\sigma}(X) \, dW^X.
\]</span></p>
<p>for two independent Brownian motions <span class="math inline">\(W^X\)</span> and <span class="math inline">\(W^H\)</span>. The volatility terms <span class="math inline">\( \textcolor{blue}{\Gamma(x)}\)</span> comes from the CLT and the drift term <span class="math inline">\( \textcolor{blue}{I(x)}\)</span> comes from the self-interaction term:</p>
<p><span id="eq-homogenized-terms"><span class="math display">\[
\left\{
\begin{align}
\Gamma(x)
&amp;= \lim_{T \to \infty} \; \mathop{\mathrm{Var}} {\left\{ T^{-1/2} \int_{0}^T H(x, Y^{[x]}_t) \, dt \right\}} \\
%
I(x)
&amp;= \lim_{T \to \infty} \; \frac{1}{T} \iint_{0&lt;u&lt;v&lt;T} H(x, Y^{[x]}_u) \, \partial_x H(x, Y^{[x]}_v) \, du \, dv.
\end{align}
\right.
\tag{6}\]</span></span></p>
<p>For the drift function, the scaling <span class="math inline">\(T^{-1} \int_{0&lt;u&lt;v&lt;T} (\ldots)\)</span> may look a bit surprising at first sight as one may expect <span class="math inline">\(T^{-2} \int_{0&lt;u&lt;v&lt;T} (\ldots)\)</span> instead. Note that since the process <span class="math inline">\(Y^{[x]}\)</span> mixes on a time scale <span class="math inline">\(\mathcal{O}(1)\)</span> and the centering condition <span class="math inline">\(\int H(x, y) \rho_x(dy)=0\)</span> holds, the expectation <span class="math inline">\(\mathop{\mathrm{E}}[H(x, Y^{[x]}_u) \, \partial_x H(x, Y^{[x]}_v)]\)</span> goes to zero as soon as <span class="math inline">\(|u-v| \gg 1\)</span>. This means that only the subset <span class="math inline">\(|u-v| = \mathcal{O}(1)\)</span> of <span class="math inline">\([0,T]^2\)</span> really matters in that double integral, hence the <span class="math inline">\((1/T)\)</span> normalization factor.</p>
</section>
<section id="closed-form-solution-poisson-equation" class="level3">
<h3 class="anchored" data-anchor-id="closed-form-solution-poisson-equation">Closed form solution &amp; Poisson equation:</h3>
<p>The drift and volatility terms <span class="math inline">\(\Gamma(x)\)</span> and <span class="math inline">\(I(x)\)</span> quantify the mixing properties of the fast process <span class="math inline">\(Y^{[x]}\)</span>. While formulas <a href="#eq-homogenized-terms">Equation&nbsp;6</a> are intuitive, they can be difficult to deal with if one needs the exact expressions of the drift and volatility functions. Instead, they can also be expressed in terms of the solution to an appropriate <a href="../../notes/Poisson_Eq_Asymp_Var/Poisson_Eq_Asymp_Var.html">Poisson equations</a>.</p>
<p><span id="eq-poisson"><span class="math display">\[
\begin{align}
I(x) &amp;=
\frac{1}{T} \iint_{[0,T]^2}
H(x,Y^{[x]}_{v}) \, \partial_x H(x,Y^{[x]}_{u}) \, 1_{v&lt;u}  \, du \, dv \\
&amp;\to
\int \rho_x(dy) \, H(x,y) \, \partial_{\hat{x}}  {\left\{  \int_{s=0}^{\infty} \mathop{\mathrm{E}}[H(\hat{x}, Y^{[x]}_s) \, |Y^{[x]}_0=y] \, ds  \right\}} \\
&amp;=
-\int \rho_x(dy) \, H(x,y) \, \partial_{x} \Phi(x,y)\\
&amp;= -\left&lt; H(x, \cdot), \partial_x \Phi(x, \cdot) \right&gt;_{\rho_x}
\end{align}
\tag{7}\]</span></span></p>
<p>where the function <span class="math inline">\(\Phi(x,y)\)</span> is solution to the <a href="../../notes/Poisson_Eq_Asymp_Var/Poisson_Eq_Asymp_Var.html">Poisson equation</a></p>
<p><span class="math display">\[
\mathcal{L}^{Y^{[x]}} \Phi(x, \cdot) = H(x, \cdot)
\]</span></p>
<p>for all <span class="math inline">\(x \in \mathcal{X}\)</span> and <span class="math inline">\(\mathcal{L}^{Y^{[x]}}\)</span> is the generator of the fast process <span class="math inline">\(dY^{[x]}/dt = G(x,Y^{[x]}, W^Y)\)</span>. The last equality in <a href="#eq-poisson">Equation&nbsp;7</a> follows from the <a href="../../notes/Poisson_Eq_Asymp_Var/Poisson_Eq_Asymp_Var.html">integral representation</a> of the Poisson equation. Similarly, and also as explained <a href="../../notes/Poisson_Eq_Asymp_Var/Poisson_Eq_Asymp_Var.html">here</a>, the asymptotic variance term can also be expressed in terms of the function <span class="math inline">\(\Phi\)</span>,</p>
<p><span class="math display">\[
\begin{align}
\Gamma(x)
&amp;= \lim_{T \to \infty} \; \mathop{\mathrm{Var}} {\left\{ T^{-1/2} \int_{0}^T H(x, Y^{[x]}_t) \, dt \right\}} \\
&amp;= -2 \int_{\mathcal{Y}} \Phi(x, y) \, H(x, y) \, \rho_x(dy)\\
&amp;= -2 \left&lt; \Phi, \mathcal{L}^{Y^{[x]}} \Phi \right&gt;_{\rho_x}.
\end{align}
\]</span></p>
</section>
<section id="example-integrated-ou-process" class="level3">
<h3 class="anchored" data-anchor-id="example-integrated-ou-process">Example: integrated OU process</h3>
<p>Consider a slow process obtained by integrating an OU process,</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon} &amp;= \varepsilon^{-1/2} \, Y^{\varepsilon} \, dt\\
dY^{\varepsilon} &amp;= -\lambda \varepsilon^{-1}\, Y^{\varepsilon} \, dt + \sqrt{2 \lambda/\varepsilon} \, dW^Y,
\end{align}
\right.
\]</span></p>
<p>where <span class="math inline">\(\lambda &gt; 0\)</span> is just a fixed time-scaling parameter. The fast OU process mixes on time scales of order <span class="math inline">\(\mathcal{O}(\varepsilon)\)</span> and has a standard Gaussian distribution as invariant distribution. Homogenization gives that in the regime <span class="math inline">\(\varepsilon\to 0\)</span>, the slow process can be approximated as</p>
<p><span id="eq-integ-OU"><span class="math display">\[
dX = \sqrt{2/\lambda} \, dW
\tag{8}\]</span></span></p>
<p>since the asymptotic variance is</p>
<p><span class="math display">\[
\mathop{\mathrm{Var}} {\left\{  T^{-1/2} \int_{t=0}^{T} Y_t \, dt \right\}}
\to
2 \, \int_{0}^{\infty} C(r) \, dr = 2/\lambda
\]</span></p>
<p>where <span class="math inline">\(C(r) = \mathop{\mathrm{E}}[Y_t Y_{t+r}] = \exp[-\lambda r]\)</span> is the autocorrelation function of the fast OU process, as explained <a href="../../notes/Poisson_Eq_Asymp_Var/Poisson_Eq_Asymp_Var.html">here</a>. The fact that the effective diffusion is (twice) the integrated autocorrelation of the fast process is an example of <a href="https://en.wikipedia.org/wiki/Green–Kubo_relations">Green-Kubo relations</a>.</p>
</section>
<section id="example-overdamped-langevin-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="example-overdamped-langevin-dynamics">Example: Overdamped Langevin Dynamics</h3>
<p>This example does not exactly fall within the homogenization result described in the previous section, but almost. Consider a potential <span class="math inline">\(U\)</span> and the slow-fast dynamics:</p>
<p><span class="math display">\[
\left\{
\begin{align}
dX^{\varepsilon} &amp;= \varepsilon^{-1/2} \, Y^{\varepsilon} \, dt\\
dY^{\varepsilon} &amp;= - \varepsilon^{-1}\, [Y^{\varepsilon}+\varepsilon^{1/2}\nabla U(X^{\varepsilon})] \, dt + \sqrt{2 /\varepsilon} \, dW^Y.
\end{align}
\right.
\]</span></p>
<p>For any fixed value of <span class="math inline">\(x \in \mathcal{X}\)</span>, the fast OU-dynamics</p>
<p><span class="math display">\[
dY = -[Y^{\varepsilon}+\varepsilon^{1/2}\nabla U(x)] \, dt + \sqrt{2} \, dW^Y
\]</span></p>
<p>converges to a Gaussian distribution with mean <span class="math inline">\(-\nabla U(x)\)</span> and unit variance. The same arguments as the previous section immediately give that, starting from <span class="math inline">\(X^{\varepsilon}_0=x\)</span>, we have</p>
<p><span class="math display">\[
\varepsilon^{-1/2} \, \int_{0}^{\delta} Y^{\varepsilon} \, dt
\; \to \;
-\nabla U(x) \, \delta + \sqrt{2 \delta} \, \mathcal{N}(0,1).
\]</span></p>
<p>The <span class="math inline">\(\sqrt{2}\)</span> terms comes from the OU asymptotic variance. this shows that the slow process converges as <span class="math inline">\(\varepsilon\to 0\)</span> to the <a href="https://en.wikipedia.org/wiki/Brownian_dynamics">overdamped Langevin dynamics</a></p>
<p><span class="math display">\[
dX = -\nabla U(X) \; + \; \sqrt{2} \, dW.
\]</span></p>
</section>
<section id="example-stratonovich-corrections" class="level3">
<h3 class="anchored" data-anchor-id="example-stratonovich-corrections">Example: Stratonovich Corrections</h3>
<p>Consider a function <span class="math inline">\(f: \mathbb{R}\to \mathbb{R}\)</span> and the slow-fast system</p>
<p><span class="math display">\[
dX^{\varepsilon} = \varepsilon^{-1/2} \, f(X^{\varepsilon}) \, Y^{\varepsilon} \, dt
\]</span></p>
<p>where <span class="math inline">\(dY^{\varepsilon} = -(\lambda/\varepsilon) Y^{\varepsilon} + \sqrt{2 \lambda / \varepsilon}\)</span> is a fast OU process mixing on scales of order <span class="math inline">\(\mathcal{O}(\varepsilon)\)</span> and with standard centred Gaussian invariant distribution <span class="math inline">\(\rho(dy)\)</span>.The discussion leading to <a href="#eq-integ-OU">Equation&nbsp;8</a> suggest that the term <span class="math inline">\(\varepsilon^{-1/2} \, Y^{\varepsilon} \, dt\)</span> can be heuristically be thought of as <span class="math inline">\((2/\lambda)^{1/2} \, dW\)</span>, which would imply that the effective dynamics for the slow-process is</p>
<p><span class="math display">\[
dX = \sqrt{2/\lambda} \, f(X) \, dW.
\]</span></p>
<p>We will see that this heuristic is <strong>wrong</strong>! In order to obtain the effective dynamics of the slow process as <span class="math inline">\(\varepsilon\to 0\)</span>, since the generator of the fast-OU reads <span class="math inline">\(\mathcal{L}\varphi= \lambda [ -y\,\varphi_y + \varphi_{yy}]\)</span>, one can solve the Poisson equation <span class="math inline">\(\mathcal{L}\Psi(x,y) = f(x)y\)</span> to obtain that <span class="math inline">\(\Phi(x,y) = -f(x)y/\lambda\)</span>. One already knows that <span class="math inline">\(\mathop{\mathrm{Var}}[T^{-1}\int_{[0,T]} Y_t \, dt] = 2/\lambda\)</span>. The drift term is given by</p>
<p><span class="math display">\[
\begin{align}
I(x) &amp;= \int f(x) \partial_x \Phi(x,y) \, \rho(dy)\\
&amp;= \lambda^{-1} \int f(x) f'(x) y^2 \, \rho(dy)\\
&amp;= \lambda^{-1} f(x) f'(x).
\end{align}
\]</span></p>
<p>Putting everything together gives that the effective slow dynamics reads</p>
<p><span class="math display">\[
\begin{align}
dX &amp;=  \textcolor{blue}{ \lambda^{-1} f'(X) f(X) \, dt } + \sqrt{2/\lambda} \, f(X) \, dW\\
&amp;= \sqrt{2/\lambda} \, f(X)  \textcolor{red}{\circ} dW
\end{align}
\]</span></p>
<p>where <span class="math inline">\( \textcolor{red}{\circ}\)</span> denotes <a href="https://en.wikipedia.org/wiki/Stratonovich_integral">Stratonovich integration</a>.</p>
</section>
<section id="readings" class="level3">
<h3 class="anchored" data-anchor-id="readings">Readings</h3>
<p>The book <span class="citation" data-cites="pavliotis2008multiscale">(<a href="#ref-pavliotis2008multiscale" role="doc-biblioref">Pavliotis and Stuart 2008</a>)</span> is beautiful, and I quite like the section on multiscale expansion in <span class="citation" data-cites="weinan2011principles">(<a href="#ref-weinan2011principles" role="doc-biblioref">Weinan 2011</a>)</span>. For proving this type of results with the “martingale problem” approach <span class="citation" data-cites="stroock1997multidimensional">(<a href="#ref-stroock1997multidimensional" role="doc-biblioref">Stroock and Varadhan 1997</a>)</span>, the lectures <span class="citation" data-cites="papanicolaou1977martingale">(<a href="#ref-papanicolaou1977martingale" role="doc-biblioref">Papanicolaou 1977</a>)</span> are nicely done.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-hinch_1991" class="csl-entry" role="listitem">
Hinch, E. J. 1991. <em>Perturbation Methods</em>. Cambridge University Press.
</div>
<div id="ref-papanicolaou1977martingale" class="csl-entry" role="listitem">
Papanicolaou, George. 1977. <span>“Martingale Approach to Some Limit Theorems.”</span> In <em>Papers from the Duke Turbulence Conference, Duke Univ., Durham, NC, 1977</em>.
</div>
<div id="ref-pavliotis2008multiscale" class="csl-entry" role="listitem">
Pavliotis, Grigoris, and Andrew Stuart. 2008. <em>Multiscale Methods: Averaging and Homogenization</em>. Springer Science &amp; Business Media.
</div>
<div id="ref-stroock1997multidimensional" class="csl-entry" role="listitem">
Stroock, Daniel W, and SR Srinivasa Varadhan. 1997. <em>Multidimensional Diffusion Processes</em>. Vol. 233. Springer Science &amp; Business Media.
</div>
<div id="ref-weinan2011principles" class="csl-entry" role="listitem">
Weinan, E. 2011. <em>Principles of Multiscale Modeling</em>. Cambridge University Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="alexxthiery/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>