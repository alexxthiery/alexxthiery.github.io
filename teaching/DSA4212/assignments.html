<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Alexandre Thiéry - DSA4212 Assignments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../../data/dice.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HJ0JLEF802"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HJ0JLEF802', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Alexandre Thiéry - DSA4212 Assignments">
<meta property="og:description" content="">
<meta property="og:site-name" content="Alexandre Thiéry">
<meta name="twitter:title" content="Alexandre Thiéry - DSA4212 Assignments">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@alexxthiery">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alexandre Thiéry</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../people/index_people.html" rel="" target="">
 <span class="menu-text">Research Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications/index_pubs.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching/teaching.html" rel="" target="">
 <span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/index_notes.html" rel="" target="">
 <span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../notes/index_notes_as_list.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#traveling-salesman-problem" id="toc-traveling-salesman-problem" class="nav-link active" data-scroll-target="#traveling-salesman-problem">Traveling Salesman Problem</a></li>
  <li><a href="#thompson-problem" id="toc-thompson-problem" class="nav-link" data-scroll-target="#thompson-problem">Thompson problem</a></li>
  <li><a href="#automatic-differentiation" id="toc-automatic-differentiation" class="nav-link" data-scroll-target="#automatic-differentiation">Automatic differentiation</a></li>
  <li><a href="#collaborative-filtering" id="toc-collaborative-filtering" class="nav-link" data-scroll-target="#collaborative-filtering">Collaborative Filtering</a></li>
  <li><a href="#natural-evolution-strategies" id="toc-natural-evolution-strategies" class="nav-link" data-scroll-target="#natural-evolution-strategies">Natural Evolution Strategies</a></li>
  <li><a href="#word-embeddings" id="toc-word-embeddings" class="nav-link" data-scroll-target="#word-embeddings">Word Embeddings</a></li>
  <li><a href="#image-classification-with-convolutional-neural-networks" id="toc-image-classification-with-convolutional-neural-networks" class="nav-link" data-scroll-target="#image-classification-with-convolutional-neural-networks">Image classification with convolutional neural networks</a></li>
  <li><a href="#lstm-for-time-series-prediction" id="toc-lstm-for-time-series-prediction" class="nav-link" data-scroll-target="#lstm-for-time-series-prediction">LSTM for time series prediction</a></li>
  <li><a href="#transformer-architecture" id="toc-transformer-architecture" class="nav-link" data-scroll-target="#transformer-architecture">Transformer architecture</a></li>
  <li><a href="#topic-of-your-choice" id="toc-topic-of-your-choice" class="nav-link" data-scroll-target="#topic-of-your-choice">Topic of your choice</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSA4212 Assignments</h1>
  <div class="quarto-categories">
    <div class="quarto-category">DSA4212</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="traveling-salesman-problem" class="level3">
<h3 class="anchored" data-anchor-id="traveling-salesman-problem">Traveling Salesman Problem</h3>
<p><strong>Goal:</strong> The Traveling Salesman Problem (TSP) is a classic problem in combinatorial optimization. Given a list of cities and the distances between each pair of cities, the problem is to find the shortest possible route that visits each city exactly once and returns to the origin city. You are tasked with implementing a few methods to solve the TSP and compare their performance. Your report should not include any actual code. Instead, it should describe the problem and provide a discussion of the results. You are encouraged to compare your results with the best known solutions.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">Wikipedia</a></li>
<li><a href="http://comopt.ifi.uni-heidelberg.de/software/TSPLIB95/">TSPLIB</a></li>
</ul>
<hr>
</section>
<section id="thompson-problem" class="level3">
<h3 class="anchored" data-anchor-id="thompson-problem">Thompson problem</h3>
<p><strong>Goal:</strong> The Thompson problem is a classic problem in computational geometry. Consider <code>N = 300</code> points <span class="math inline">\(P_1, P_2, \ldots, P_N \in \mathbb{R}^3\)</span> on the unit sphere: for <span class="math inline">\(1 \leq i \leq N\)</span>, we have <span class="math inline">\(\|P_i\| = 1\)</span>. How should these points be placed so that the quantity</p>
<p><span class="math display">\[
E = \sum_{i=1}^{N} \sum_{j=1}^{N} \frac{1}{\|P_i - P_j\|}
\]</span></p>
<p>is minimized. Note that it is the norm, and not the norm squared, in the denominator. Your report should not include any actual code. Instead, it should describe the problem and provide a discussion of the results. You are encouraged to compare your results with the best known solutions.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Thomson_problem">Wikipedia</a></li>
</ul>
<hr>
</section>
<section id="automatic-differentiation" class="level3">
<h3 class="anchored" data-anchor-id="automatic-differentiation">Automatic differentiation</h3>
<p><strong>Goal:</strong> Implement a simple version of automatic differentiation in Python. Your implementation should be able to easily compute the gradient of the composition of any number of (simple) multivariate functions. While your report should not include any actual code, it should describe the mechanics of your implementation and provide examples of its use.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Automatic_differentiation">Automatic Differentiation</a><br>
</li>
<li><a href="https://youtu.be/VMj-3S1tku0?si=1aVPrUNfLoSfAFGk">Andrej Karpathy</a><br>
</li>
<li><a href="https://youtu.be/wG_nF1awSSY?si=-0uxHzNaO8b5xI4u">Ari Seff</a><br>
</li>
<li><a href="https://colah.github.io/posts/2015-08-Backprop/">Chris Olah</a></li>
</ul>
<hr>
</section>
<section id="collaborative-filtering" class="level3">
<h3 class="anchored" data-anchor-id="collaborative-filtering">Collaborative Filtering</h3>
<p><strong>Goal:</strong> Implement a collaborative filtering algorithm in Python from scratch – you should not use any high-level library such as <code>surprise</code> since this would defeat the purpose of the assignment. For testing your implementation, you will use the song dataset available <a href="https://www.kaggle.com/datasets/rymnikski/dataset-for-collaborative-filters">here</a>. You are tasked to implement variations of the matrix factorization algorithms discussed in class and compare their performance with other approaches of your choice. Your report should not include any actual code. Instead, it should describe the approach you used, the results, and provide a discussion of the findings.</p>
<hr>
</section>
<section id="natural-evolution-strategies" class="level3">
<h3 class="anchored" data-anchor-id="natural-evolution-strategies">Natural Evolution Strategies</h3>
<p>The class of algorithms known as NaturalEvolutionStrategies (NES) has demonstrated significant potential in various fields of applied mathematics and machine learning. In this project, you will provide an overview of NES and apply these approaches to three optimization problems of your choice. Your report should not include any actual code. Instead, it should describe what NES are, how they work, and provide a discussion of the results.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://arxiv.org/abs/1106.3708">Information-geometric optimization algorithms: A unifying pic- ture via invariance principles</a><br>
</li>
<li><a href="https://arxiv.org/abs/1703.03864">Evolution Strategies as a Scalable Alternative to Reinforcement Learning</a><br>
</li>
<li><a href="https://lilianweng.github.io/posts/2019-09-05-evolution-strategies/">Evolution Strategies</a></li>
<li><a href="https://www.jmlr.org/papers/volume15/wierstra14a/wierstra14a.pdf">Natural Evolution Strategies</a></li>
</ul>
<hr>
</section>
<section id="word-embeddings" class="level3">
<h3 class="anchored" data-anchor-id="word-embeddings">Word Embeddings</h3>
<p><strong>Goal:</strong> Implement a simple word embedding in Python and use it to find the most similar words to a given word. Your report should not include any actual code. Instead, it should describe how word embeddings work, how you implemented it, and provide a discussion of the results.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLhWB2ZsrULv-wEM8JDKA1zk8_2Lc88I-s">Andrew Ng</a><br>
</li>
<li><a href="https://youtu.be/ISPId9Lhc1g?si=gJC_GF7Oj0sq9GVD">The illustrated Word2Vec</a></li>
</ul>
<hr>
</section>
<section id="image-classification-with-convolutional-neural-networks" class="level3">
<h3 class="anchored" data-anchor-id="image-classification-with-convolutional-neural-networks">Image classification with convolutional neural networks</h3>
<p><strong>Goal:</strong> Implement a simple convolutional neural network in Python and use it to classify images from the CIFAR-10 dataset. For this purpose, you will implement a small CNN on a GPU (eg. Google Colab) – the actual details of the CNN is not the emphasis of this assignment and you should not spend too much time optimizing the architecture. Instead, you will study:</p>
<ul>
<li>the influence of the choice of optimizer<br>
</li>
<li>the effect of the learning rate on the speed of convergence and the final test accuracy<br>
</li>
<li>whether using a learning rate schedule improves performance<br>
</li>
<li>the effect of the batch size on the speed of convergence and the final test accuracy</li>
</ul>
<p>Your report should not include any actual code. Instead, it should describe your experiments and their results, and provide a discussion of the findings.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://arxiv.org/abs/1708.07120">Super-Convergence: Very Fast Training of Neural Networks Using Large Learning Rates</a><br>
</li>
<li><a href="https://myrtle.ai/learn/how-to-train-your-resnet/">How to train your ResNet</a></li>
<li><a href="https://github.com/google-research/tuning_playbook">Deep Learning Tuning Playbook</a></li>
</ul>
<hr>
</section>
<section id="lstm-for-time-series-prediction" class="level3">
<h3 class="anchored" data-anchor-id="lstm-for-time-series-prediction">LSTM for time series prediction</h3>
<p><strong>Goal:</strong> Implement a simple LSTM in Python and from scratch, ie. not use the <code>LSTM(...)</code> function of a high-level library. You will then use your implementation to predict the next value in a time series dataset of your choice. Your report should not include any actual code. Instead, it should describe how a LSTM works, how you implemented it, and provide a discussion of the results.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a></li>
<li><a href="https://youtu.be/q12VPh-bK7k?si=jVy3dUVITnTBQOFf">Zico Kolter</a><br>
</li>
<li><a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">The Unreasonable Effectiveness of Recurrent Neural Networks</a></li>
<li><a href="https://arxiv.org/abs/1804.11188">Can recurrent neural networks warp time?</a></li>
</ul>
<hr>
</section>
<section id="transformer-architecture" class="level3">
<h3 class="anchored" data-anchor-id="transformer-architecture">Transformer architecture</h3>
<p><strong>Goal:</strong> Implement a simple transformer in Python and from scratch, ie. not use the <code>Transformer(...)</code> function of a high-level library.</p>
<p>Some examples of simple task that can be used to test the transformer are:</p>
<ul>
<li>Sequence Reversal: reversing a sequences of numbers, <code>[1,3,2,4,5,3] -&gt; [3,5,4,2,3,1]</code>.<br>
</li>
<li>Basic Arithmetic: learning simple arithmetic operation is a surprisingly challenging task for a transformer. For example, given a sequence of numbers and arithmetic operations, the model should output the result of the operations. <code>[1,3,2,"+",9,4,2]-&gt;[1,0,7,4]</code>. <code>[1,3,2,"+",9,4,2]-&gt;[1,0,7,4]</code><br>
</li>
<li>Copying Task: A simple task where the model’s objective is to output the same sequence it receives as input. This might seem trivial but is a good starting point: <code>[1,3,2,4,5,3]-&gt;[1,3,2,4,5,3]</code><br>
</li>
<li>Sorting Numbers: This can be very challenging for a transformer, especially if the sequence is long. <code>[1,3,2,4,5,3]-&gt;[1,2,3,3,4,5]</code><br>
</li>
<li>Character-Level Text Generation: Generating text one character at a time, based on a given prompt or starting character.</li>
</ul>
<p>Your report should not include any actual code. Instead, it should describe how a transformer works, how you implemented it, and provide a discussion of the results.</p>
<p><strong>Possible References:</strong></p>
<ul>
<li><a href="http://nlp.seas.harvard.edu/2018/04/03/attention.html">The Annotated Transformer</a><br>
</li>
<li><a href="https://colab.research.google.com/github/phlippe/uvadlc_notebooks/blob/master/docs/tutorial_notebooks/JAX/tutorial6/Transformers_and_MHAttention.ipynb">JAX: Transformers and Multi-Head Attention</a></li>
<li><a href="https://jaykmody.com/blog/gpt-from-scratch/">GPT in 60 lines of code</a></li>
<li><a href="https://lilianweng.github.io/posts/2023-01-27-the-transformer-family-v2/">The Transformer Family</a></li>
<li><a href="https://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></li>
<li><a href="https://youtu.be/U0s0f995w14?si=iRHalYWe_2l-WKKP">pytorch transformer from scratch</a><br>
</li>
<li><a href="https://youtu.be/rPFkX5fJdRY?si=xX0zbInQ7e8GG1lh">Transformers: Zero to Hero</a></li>
</ul>
<hr>
</section>
<section id="topic-of-your-choice" class="level3">
<h3 class="anchored" data-anchor-id="topic-of-your-choice">Topic of your choice</h3>
<p>Propose a topic and contact me to discuss it and for approval.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>